# 12주차 프로젝트 가이드: Spring Boot 포트폴리오 & 게시판

## 1. 이번 주 목표
- Spring Boot + Thymeleaf 기반 포트폴리오 & 게시판 프로젝트 마무리
- 회원 가입/로그인(세션)과 게시판 CRUD 흐름 정리
- 연락/지도 섹션 실구현, DB 영속화/보안 보완 계획 수립
- 배포 전 점검 및 패키징 방법 정리

## 2. 실행 환경 & 빌드
- 요구사항: JDK 21, Maven Wrapper 사용(`mvnw`, `mvnw.cmd`)
- 로컬 실행: `./mvnw spring-boot:run`
- 기본 포트: 8080 (`http://localhost:8080`)
- DB: H2 메모리(`jdbc:h2:mem:testdb`), `spring.jpa.hibernate.ddl-auto=create`로 재시작 시 초기화됨  
  - 콘솔: `/h2-console` (JDBC URL 그대로 사용)  
  - 영속 DB가 필요하면 `application.properties`의 MySQL 설정 주석 해제 후 `ddl-auto=update` 등으로 변경
- 패키징: `./mvnw clean package` → `target/jar-0.0.1-SNAPSHOT.jar`  
  - 실행: `java -jar target/jar-0.0.1-SNAPSHOT.jar`

## 3. 프로젝트 구조(핵심 경로)
- 엔트리: `jar/src/main/java/com/example/jar/JarApplication.java`
- 보안: `config/SecurityConfig.java` (CSRF 비활성, 모든 요청 permitAll, 세션 무효 시 `/member_login`, 폼 로그인 비활성)
- 컨트롤러  
  - `DemoController`: 홈(`/`), 소개(`/about_detailed`), 샘플(`/hello1004`, `/testdb`)  
  - `MemberController`: 회원가입(`/join_new`, POST `/api/members`), 로그인(`/member_login`, POST `/api/login_check`), 로그아웃(`/logout`)  
  - `BoardController`: 게시판 목록(`/article_list`, `/board_list`), 조회(`/board_view/{id}`), 수정폼(`/board_edit/{id}`), 수정 POST(`/api/boards/update/{id}`)  
  - `BoardRestController`: 게시글 등록 POST(`/api/boards`), 단건 조회 GET(`/api/boards/{id}`), 조회수 증가 GET(`/api/boards/{id}/view`), 삭제 DELETE(`/api/boards/{id}`), 좋아요 POST(`/api/boards/{id}/like`)  
  - `BlogController/BlogRestController`: 기존 Article 기반 레거시 목록/CRUD(현재 UI는 Board를 사용)  
  - `GlobalExceptionHandler`: 잘못된 파라미터/비즈니스 예외 400 처리
- 도메인: `model/domain`  
  - `Board(id, title, content, author, createdAt, viewCount, likeCount)`  
  - `Member(id, name, email, password, age, mobile, address)`  
  - `Article`(레거시), `TestDB`(샘플)
- 서비스/리포지토리: `model/service`, `model/repository` (JPA, 페이지네이션/검색/조회수·좋아요 증가 쿼리 포함)
- 뷰 템플릿: `src/main/resources/templates`  
  - `index.html`(메인/BOARD 섹션 상위 3개 노출), `article_list2.html`(게시판 메인 UI), `board_edit.html`, `board_view.html`, `join_new.html`, `login.html`, `error/400.html`
- 정적 리소스: `src/main/resources/static` (Tailwind, 폰트, 이미지 등)

## 4. 인증/세션 흐름
- 회원가입: `/join_new` 폼 → POST `/api/members`  
  - `AddMemberRequest`로 검증(@Email, 비밀번호 복잡도, 나이 범위 등), Bcrypt 인코딩 후 저장, 이메일 중복 검사
- 로그인: `/member_login` 폼 → POST `/api/login_check`  
  - 성공 시 세션에 `memberId`, `email`, `name` 저장
- 로그아웃: `/logout` (세션 무효 + JSESSIONID 쿠키 삭제)
- 보호 방식: Spring Security는 permitAll이지만 컨트롤러에서 세션 `email` 체크로 등록/수정/삭제 제한

## 5. 게시판(BOARD) 기능 요약
- 목록: GET `/article_list` (UI: `article_list2.html`)  
  - 파라미터 `page`(0부터), `keyword`(제목 검색). 기본 페이지 크기 3, 최신순 정렬
- 등록: POST `/api/boards`  
  - 폼 데이터(title, content). 세션 `email`이 author로 기록됨(없으면 401)
  - JSON으로 저장된 Board 반환 → 프론트에서 즉시 prepend
- 단건 조회/조회수: GET `/api/boards/{id}` 또는 `/api/boards/{id}/view` (후자는 viewCount +1 후 반환)
- 수정: GET `/board_edit/{id}` → POST `/api/boards/update/{id}`  
  - 글쓴이와 세션 email 일치 시에만 허용
- 삭제: DELETE `/api/boards/{id}` (글쓴이만 가능)
- 좋아요: POST `/api/boards/{id}/like` (카운트 +1, 응답에 갱신된 Board)
- 프론트 연동  
  - `templates/article_list2.html`: Tailwind UI, fetch로 작성/삭제/모달 조회, 페이지네이션/검색 UI 포함  
  - `templates/index.html`의 BOARD 섹션: 최신 3개 게시글을 리스트/모달로 제공, “게시판 바로가기” 버튼으로 `/article_list`

## 6. 화면 라우팅 맵
- `/` → `index.html` (포트폴리오 + BOARD 섹션)
- `/article_list` → `article_list2.html` (Board 메인)
- `/board_edit/{id}` → 게시글 수정 폼
- `/join_new` → 회원가입, `/member_login` → 로그인, `/logout` → 로그아웃
- `/h2-console` → H2 콘솔(로컬 개발용)

## 7. 12주차 작업 제안(현 상태 기준)
1) CONTACT 섹션 실구현  
   - `index.html`의 연락 영역에 form(action="/api/contacts", method="post") 추가  
   - 단순 저장: `ContactMessage` 엔티티/리포지토리 + 컨트롤러 생성 후 DB 저장 또는 지정 경로에 txt 저장  
   - 관리자 확인용 완료 페이지/토스트 추가

2) 지도 교체  
   - 실제 위치의 Google Maps iframe으로 교체(`width="100%" height="450"` 등), CONTACT 섹션에 배치

3) 데이터 영속화 전환  
   - 운영용 DB(MySQL 등) 설정, `ddl-auto=update` 또는 명시적 스키마 관리, 계정/비밀번호 환경변수로 분리

4) 보안 다듬기  
   - SecurityConfig에서 작성/수정/삭제/좋아요 등을 인증 사용자로 제한하고 CSRF 재활성화 검토  
   - 세션 만료, 에러 페이지 UX 정비(403/400)

## 8. 배포 전 체크리스트
- `./mvnw clean package`로 빌드 성공 여부 확인
- H2→운영 DB 전환 후 마이그레이션 검증
- 기본 계정 생성 및 로그인/게시글 흐름 E2E 테스트
- 정적 리소스(이미지/폰트) 경로와 외부 CDN 접근성 확인
